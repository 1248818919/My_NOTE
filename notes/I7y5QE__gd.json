{"_id":"note:I7y5QE__gd","title":"FFT","content":"# Fast Fourier Transform 快速傅里叶变换\n\n## 1.问题引入\n\n对于多项式$f(x)=\\sum^{n}_{i=0}a_ix^i,g(x)=\\sum^{n}_{i=0}b_ix^i$,定义他的乘积$fg$为\n\n$(f g)(x)=\\left(\\sum_{i=0}^n a_i x^i\\right)\\left(\\sum_{i=0}^n b_i x^i\\right)$\n\n显然我们可以以$O(n^2)$的复杂度计算这个乘积的每一项的系数,然而FFT可以用$O(nlogn)$的时间复杂度来进行计算。\n\n## 2.复数的定义与几何图景\n\n形如 $a+b \\mathrm{i} \\quad(a, b \\in \\mathbb{R})$ 的表达式被称为复数， $\\mathbb{C}$ 是全体复数构成的集合。我们称 $\\mathrm{i}$ 为虚数单位。定义两个复数 $a_1+b_1 \\mathrm{i}, a_2+b_2 \\mathrm{i}$ 相等当且仅当 $a_1=a_2$ 且 $b_1=b_2$ 。\n\n$z=a+b \\mathrm{i}$ 中的 $a$ 被称为 $z$ 的实部， $b$ 被称为 $z$ 的虚部。在 $b=0$ 时，将 $z$ 视同 $a$ ；当 $a=0$ 且 $b \\neq 0$ 时，称 $z$ 为纯虚数。\n\n注意到复数也可以被视作有序实数对，故全体复数与平面上所有点存在一一对应。将平面直角坐标系中的点的横坐标视作实部，纵坐标视作虚部，则每一个点 $(a, b)$ 都唯一对应这一个复数 $a+b \\mathrm{i}$ ，此时与复数有上述一一对应关系的平面被称作复平面。\n\n对复数 $z_1=a_1+b_1 \\mathrm{i}, z_2=a_2+b_2 \\mathrm{i}$ ，其具有加法和乘法\n$$\n\\begin{aligned}\nz_1+z_2 & =\\left(a_1+a_2\\right)+\\left(b_1+b_2\\right) \\mathrm{i} \\\\\nz_1 \\cdot z_2 & =\\left(a_1 a_2-b_1 b_2\\right)+\\left(a_1 b_2+a_2 b_1\\right) \\mathrm{i}\n\\end{aligned}\n$$\n\n特别地\n$\\mathrm{i} \\cdot \\mathrm{i}=-1$\n\n记 $-z=(-1) \\cdot z ， z_1-z_2=z_1+\\left(-z_2\\right)$ ，从而我们有了复数的减法。依定义复数的加法和减法在复平面上对应于原点到复数的向量的向量加法和减法。\n\n在实数域上一个实数 $r$ 的乘法逆元是其倒数，所谓逆元意为 “可在乘法中抵消” 即 $r \\cdot \\frac{1}{r}=1$ ，也就是除法。为在复数域上寻找类似的逆元，定义复数 $z=a+b i$ 的共轭复数 $\\bar{z}$ 为 $\\bar{z}=a-b \\mathrm{i}$ ，则 $z \\cdot \\bar{z}=|z|^2$ ， 进而\n$$\n\\forall z \\in \\mathbb{C}-\\{0\\}, \\frac{1}{|z|^2} \\cdot z \\cdot \\bar{z}=1\n$$\n\n所以有 $\\frac{1}{z}=\\bar{z} /|z|^2$ 为 $z$ 的乘法逆元。\n\n![复数的加法与共轭](https://github.com/1248818919/My_NOTE/blob/master/assets/None%20class/FFT/pig.png?raw=true)\n\n容易验证复数加法和乘法具有交换律、结合律、分配律，乘法对加法具有交换律、结合律，其余诸多与$\\mathbb{R}$或$\\mathbb{Q}$类似的加法性质不再一一赘述，读者可查阅.\n\n>https://www.qiuwenbaike.cn/wiki/%E5%9F%9F%EF%BC%88%E6%95%B8%E5%AD%B8%EF%BC%89\n\n一个复数的模长为其实部与虚部的平方之和的算术平方根 (也就是复数到原点的 (欧式) 几何距离)，复数 $z$ 的模长写作 $|z|$ 。即\n$$\n|a+b \\mathrm{i}|=\\sqrt{a^2+b^2}\n$$\n\n定义两个复数 $z, w$ 之间的距离 $d(z, w)=|z-w|$ ，可以发现其满足\n- (正定性) $d(z, w) \\geq 0$ ， 且 $d(z, w)=0 \\Leftrightarrow z=w$ ，直观上即两点距离不小于零，若为零则两点重合\n- (对称性) $d(z, w)=d(w, z)$ ，直观上是 $z$ 到 $w$ 距离和 $w$ 到 $z$ 距离相等\n- (三角不等式) $d(z, w) \\geqslant d\\left(z, z^{\\prime}\\right)+d\\left(z^{\\prime}, w\\right)$ ，直观上是三角形两边之和大于第三边\n\n可以发现这类似于实数的绝对值。我们称满足这三条性质意义下的 $(\\mathbb{C}, d)$ 是一个度量空间。\n容易验证对任意复数 $z_1, z_2$ ，有 $\\left|z_1 \\cdot z_2\\right|=\\left|z_1\\right| \\cdot\\left|z_2\\right|$ 。一如极坐标，复数 $z=a+b \\mathrm{i}$ 可以被唯一表示为 $z=r(\\cos \\theta+\\mathrm{i} \\sin \\theta)$ 的形式，我们称其为复数 $z$ 的三角形式，其中 $r$ 等于 $|z|$。 $\\theta$ 被称为复数 $z$ 的辐角。辐角有无数个，但在 $(-\\pi, \\pi]$ 上只有一个，将之称为辐角主值记作 $\\theta=\\arg (z)$\n\n可以发现这类似于实数的绝对值。我们称满足这三条性质意义下的$(\\mathbb{C},d)$是一个度量空间。\n\n容易验证对任意复数 $z_1, z_2$ ，有 $\\left|z_1 \\cdot z_2\\right|=\\left|z_1\\right| \\cdot\\left|z_2\\right|$ 。一如极坐标，复数 $z=a+b \\mathrm{i}$ 可以被唯一表示为 $z=r(\\cos \\theta+\\mathrm{i} \\sin \\theta)$ 的形式，我们称其为复数 $z$ 的三角形式，其中 $r$ 等于 $|z|$。 $\\theta$ 被称为复数 $z$ 的辐角。辐角有无数个，但在 $(-\\pi, \\pi]$ 上只有一个，将之称为辐角主值记作 $\\theta=\\arg (z)$\n\n![复数z的模厂和三角形式](https://github.com/1248818919/My_NOTE/blob/master/assets/None%20class/FFT/%E5%A4%8D%E6%95%B0z%E7%9A%84%E6%A8%A1%E5%8E%82%E5%92%8C%E4%B8%89%E8%A7%92%E5%BD%A2%E5%BC%8F.png?raw=true)\n\n设复数 $z_1=r_1\\left(\\cos \\theta_1+\\mathrm{i} \\sin \\theta_1\\right) ， z_2=r_2\\left(\\cos \\theta_2+\\mathrm{i} \\sin \\theta_2\\right)$ ，则有:\n$$\n\\begin{aligned}\nz_1 z_2 & =r_1 r_2\\left(\\cos \\theta_1+\\mathrm{i} \\sin \\theta_1\\right) \\cdot\\left(\\cos \\theta_2+\\mathrm{i} \\sin \\theta_2\\right) \\\\\n& =r_1 r_2\\left[\\left(\\cos \\theta_1 \\cos \\theta_2-\\sin \\theta_1 \\sin \\theta_2\\right)+\\mathrm{i}\\left(\\sin \\theta_1 \\cos \\theta_2+\\cos \\theta_1 \\sin \\theta_2\\right)\\right] \\\\\n& =r_1 r_2\\left[\\cos \\left(\\theta_1+\\theta_2\\right)+\\mathrm{i} \\sin \\left(\\theta_1+\\theta_2\\right)\\right]\n\\end{aligned}\n$$\n\n可以发现两个复数的乘积模长为两个复数模长的乘积，辐角为两个复数辐角之和。\n\n由于复数的乘法和除法互为逆运算，故两个复数之商 (第二个复数非零) 的模长为两个复数模长之商，辐角为两个复数辐角之差。\n\n### 直观理解\n\n![img]()","tags":[],"folderPathname":"/None class","data":{},"createdAt":"2023-12-16T07:47:03.276Z","updatedAt":"2023-12-18T04:00:06.664Z","trashed":false,"_rev":"v9ypCruJH"}