{"_id":"note:H18N4Pq_Na","title":"MGN","content":"# MGN论文阅读笔记\n\n> Wang G, Yuan Y, Chen X, et al. Learning discriminative features with multiple granularities for person re-identification[C]//Proceedings of the 26th ACM international conference on Multimedia. 2018: 274-282.\n\n## 1.Overview\n\n全局特征和局部特征的结合已经成为提高个人重新识别（re-ID）任务中的判别性能的重要解决方案。以前的基于零件的方法主要集中在定位具有特定预定义语义的区域以学习局部表示，这增加了学习难度，但对具有大方差的场景来说效率或鲁棒性较差。在本文中，我们提出了一种端到端的特征学习策略，该策略集成了具有不同粒度的判别信息。我们仔细设计了多粒度网络（MGN），这是一种多分支深度网络架构，由一个全局特征表示分支和两个局部特征表示分支组成。我们不是在语义区域上学习，而是将图像均匀地划分为几个条纹，并改变不同局部分支中的部分数量，以获得具有多粒度的局部特征表示。在th上实施的综合实验\n\n## 2.Related Work\n\n全局学习可以学习到最显著的外观线索，但是容易忽略不显著或者不频繁出现的细节，为了解决这个问题，一些学习任务局部特征的方法被提出了。作者对这些方法进行了归类，可分为三种主要途径：\n- 1）定位具有较强结构信息的部位区域，如关于人体的经验知识或较强的基于学习的姿势信息；\n- 2）通过区域建议方法定位零件区域；\n- 3）通过对显著分区的中层关注来增强特征。\n\n但是上面这些方法也有一些问题：\n\n- 1）姿态或遮挡变化会影响局部表示的可靠性。\n- 2）几乎只关注具有固定语义的特定部分，而不能覆盖所有的判别信息。\n- 3）不是端到端的学习过程，这增加了特征学习的复杂性和难度。\n\n## 3.Method\n\n![res](https://github.com/1248818919/My_NOTE/blob/master/assets/Computer_Vision/Track/CrossView/MGN/feature_response.jpg?raw=true)\n\n整张图片关注的是人物的整体特征，但是局部图片开始关注细节。根据这个灵感，作者提出了如下的网络模型\n\n![model](https://github.com/1248818919/My_NOTE/blob/master/assets/Computer_Vision/Track/CrossView/MGN/model.jpg?raw=true)\n\n具体的，与原始版本最明显的不同之处在于，我们将res_conv4_1块之后的部分划分为三个独立的分支，与原始ResNet-50共享相似的架构。\n\n![branches](https://github.com/1248818919/My_NOTE/blob/master/assets/Computer_Vision/Track/CrossView/MGN/branches.jpg?raw=true)\n\n**损失函数处**\n\n对于基本判别学习，我们将识别任务视为一个多类分类问题。$f_i$表示第i个目标学习到特征，在所有学习到的嵌入中，我们对1×1卷积约简前的全局特征$\\left\\{\\mathbf{z}_g^G, \\mathbf{z}_g^{P 2}, \\mathbf{z}_g^{P 3}\\right\\}$ 和约简后的部分特征 $\\left\\{\\left.\\mathbf{f}_{p_i}^{P 2}\\right|_{i=1} ^2,\\left.\\mathbf{f}_{p_i}^{P 3}\\right|_{i=1} ^3\\right\\}$使用了softmax损失。\n\n$$\nL_{\\text {softmax }}=-\\sum_{i=1}^N \\log \\frac{e^{\\mathbf{W}_{y_i}^T \\mathbf{f}_{\\mathrm{i}}}}{\\sum_{k=1}^C e^{\\mathbf{W}_k^T \\mathbf{f}_{\\mathbf{i}}}}\n$$\n\n然后对每个分支的全局特征使用Triplet loss，候选三元组由最远的正采样对和最近的负采样对构建，即在具有P个选定身份和每个身份的K个图像的小批量中最难的正和负采样对。\n\n$$\n\\begin{gathered}\nL_{\\text {triplet }}=-\\sum_{i=1}^P \\sum_{a=1}^K\\left[\\alpha+\\max _{p=1 \\ldots K}\\left\\|\\mathbf{f}_a^{(i)}-\\mathbf{f}_p^{(i)}\\right\\|_2\\right. \\\\\n\\left.-\\min _{\\substack{n=1 \\ldots K \\\\\nj=1 \\ldots P \\\\\nj \\neq i}}\\left\\|\\mathbf{f}_a^{(i)}-\\mathbf{f}_n^{(j)}\\right\\|_2\\right]_{+}\n\\end{gathered}\n$$\n\n## 4.Result\n\n![res1](https://github.com/1248818919/My_NOTE/blob/master/assets/Computer_Vision/Track/CrossView/MGN/res1.jpg?raw=true)\n\n![res2](https://github.com/1248818919/My_NOTE/blob/master/assets/Computer_Vision/Track/CrossView/MGN/res2.jpg?raw=true)\n\n![res3](https://github.com/1248818919/My_NOTE/blob/master/assets/Computer_Vision/Track/CrossView/MGN/res3.jpg?raw=true)\n\n## 5.消融实验\n\n根据我们对MGN体系结构的最初动机，在一个分支中学习全局和局部表示似乎是合理的。我们可以直接将res_conv5_3提取的相同的最终特征映射分割成不同数量的条纹，并应用相应的监控信号作为我们提出的方法。但是，我们发现这种设置对于进一步提高性能并不有效。其原因可能是共享相似网络架构的分支(主要是ResNet-50的第四残差阶段)只是对图像上不同层次的详细信息做出了响应。用一个混合的单一分支学习多个粒度的特征可能会淡化详细信息的重要性。此外，我们尝试在较浅或较深的层后拆分骨干网络，也没有取得更好的性能。\n\n我们的网络架构中的三个分支实际上学习以不同的偏好表示信息。具有更大接收场和全局max-pooling的Global Branch从行人图像中捕获了整体但粗糙的特征，而Part-2和Part-3 Branch在没有strided convolution和split parts of stripes的情况下学习到的特征往往是局部但精细的。具有更多分区的分支将学习更好的行人图像表示。学习不同偏好的分支可以协同补充低级鉴别信息到共同的骨干部分，这是任何单个分支性能提升的原因。\n\n![abl](https://github.com/1248818919/My_NOTE/blob/master/assets/Computer_Vision/Track/CrossView/MGN/abliation.jpg?raw=true)\n\n![view](https://github.com/1248818919/My_NOTE/blob/master/assets/Computer_Vision/Track/CrossView/MGN/view.jpg?raw=true)","tags":[],"folderPathname":"/Computer Vision/Track/cross_view","data":{},"createdAt":"2023-12-25T06:39:24.403Z","updatedAt":"2023-12-25T16:00:59.412Z","trashed":false,"_rev":"zrNboufU-"}